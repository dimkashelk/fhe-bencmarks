# Lattigo Benchmark Tool

Этот инструмент выполняет бенчмарки операций гомоморфного шифрования для схем BFV, CKKS и BGV в библиотеке Lattigo.

## Что измеряется

Программа замеряет время выполнения следующих операций (в микросекундах, μs):

1. **Генерация релинеаризации** - генерация ключа релинеаризации
2. **Генерация Galois ключей** - генерация ключей для автоморфизмов (вращений)
3. **Шифрование** - шифрование plaintext → ciphertext
4. **Дешифрование** - расшифрование ciphertext → plaintext
5. **Сложение** - сложение двух зашифрованных текстов
6. **Умножение** - умножение двух зашифрованных текстов (без релинеаризации)
7. **Релионеаризация** - релинеаризация после умножения (степень 2 → степень 1)
8. **Вращение (rotate rows 1 шаг)** - вращение строк (row rotation) / conjugate
9. **Сериализация шифротекста** - преобразование ciphertext в байты
10. **Сжатая сериализация (ZLIB)** - сериализация + сжатие ZLIB
11. **Сжатая сериализация (Zstandard)** - сериализация + сжатие Zstandard

## Параметры

Каждая схема тестируется с тремя наборами параметров:

- **4096** (LogN=12) - малый размер кольца
- **8192** (LogN=13) - средний размер кольца
- **16384** (LogN=14) - большой размер кольца

Все параметры соответствуют 128-битной безопасности согласно стандартным оценкам.

## Схемы

### BFV (реализовано через BGV)

Схема для целочисленных вычислений. В Lattigo v6 BFV реализован через BGV scheme.

### CKKS

Схема для вычислений с комплексными/вещественными числами с фиксированной точностью.

### BGV

Схема для целочисленных вычислений по модулю plaintext.

## Сборка и запуск

### Быстрый старт (рекомендуется)

```bash
cd bench
make all
```

Эта команда автоматически:

1. Проверит требования (Go 1.20+)
2. Установит зависимости
3. Соберет бинарник
4. Запустит бенчмарки
5. Покажет результаты

### Доступные команды Make

```bash
make help          # Показать все доступные команды
make info          # Показать информацию о проекте
make build         # Только собрать бинарник
make run           # Собрать и запустить бенчмарки
make run-only      # Запустить без пересборки
make view          # Показать результаты
make clean         # Удалить собранные файлы
```

### Ручная сборка (без Make)

```bash
# Инициализация и установка зависимостей
cd bench
go mod init bench
go mod edit -replace github.com/tuneinsight/lattigo/v6=../
go mod tidy

# Сборка
go build -o lattigo-bench .

# Запуск
./lattigo-bench
```

Результаты будут сохранены в `results.csv` в формате:

```
Операция,BFV 4096,BFV 8192,BFV 16384,CKKS 4096,CKKS 8192,CKKS 16384,BGV 4096,BGV 8192,BGV 16384
Генерация релинеаризации,633.580,3957.370,20219.480,...
Шифрование,159.090,677.270,3248.160,...
...
```

Все времена указаны в **микросекундах (μs)** - среднее по 100 итерациям.

## Зависимости

- Go 1.20+
- Lattigo v6
- github.com/klauspost/compress/zstd (для Zstandard сжатия)

Программа использует локальную версию Lattigo из родительского каталога через `replace` директиву в `go.mod`.

## Производительность

Типичное время выполнения полного бенчмарка (9 наборов параметров × 11 операций × 100 итераций):

- На современном процессоре: ~2-5 минут
- Большие параметры (16384) требуют значительно больше времени и памяти

## Детали реализации

- Количество итераций: **N = 100** (можно изменить в коде)
- Каждая операция измеряется отдельно
- Секретный ключ генерируется один раз для каждого набора параметров
- Ключи релинеаризации и Galois измеряются отдельно (усредняются по N итераций)
- Остальные операции усредняются по N итерациям
- Используются случайные данные для тестирования
- Времена измеряются в микросекундах (μs) для лучшей точности

## Примечания

- BFV в таблице - это на самом деле BGV, так как в Lattigo v6 нет отдельной схемы BFV
- Для CKKS "rotate rows" реализовано как Conjugate (комплексное сопряжение)
- Для BGV "rotate rows" использует RotateRows (обмен строк матрицы plaintext)
- Сжатие (ZLIB/Zstandard) применяется к уже сериализованному ciphertext
- Результаты зависят от процессора, памяти и текущей нагрузки системы
- Значения могут отличаться от приведенных на скриншоте в зависимости от железа
